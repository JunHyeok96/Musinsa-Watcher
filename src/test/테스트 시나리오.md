# 테스트 시나리오

## 도메인 테스트
### 엔티티 통합/슬라이스 테스트
1. log entity 저장 테스트
2. 가격 조회 테스트
3. master와 slave의 repository는 분리된다.
4. master와 slave의 queryDsl은 분리된다.
5. 큰 이미지 url를 만든다
6. 특정 검색어를 상품 수를 카운트한다
7. 특정 검색어를 조회한다.
8. 잘못된 검색어를 조회한다.
9. 특정 카테고리의 상품 수를 카운트한다
10. 특정 카테고리를 조회한다.
11. 가격과 상품을 같이 조회한다
12. 마지막 업데이트된 시간을 조회한다
13. 특정 브랜드를  조회한다.
14. 특정 브랜드중 오늘 업데이트된 데이터를 조회한다.
15. 특정 브랜드중 오늘 업데이트된 데이터, 특정 카테고리를 조회한다.
16. 브랜드 리스트를 이니셜로 조회한다.
17. 무신사 사이트로 유입되는 outbound log를 저장한다.
18. 인터셉터에서 request log를 저장한다.

### 서비스로직 단위 테스트
1. 가격 데이터를 조회한다.
2. 오늘 할인 폭이 큰 상품을 조회한다.
3. 오늘 역대 최저가 상품 조회한다.
4. 카테고리 상품을 조회한다.
5. 브랜드 상품을 조회한다.
6. 검색 결과를 조회한다.
7. 브랜드를 이니셜로 조회한다.
8. 오늘 할인 품목 수를 조회한다.
9. 오늘 역대 최저가 품목 수를 조회한다.

### 컨트롤러 테스트
1. 일자별 상품 상세정보 조회
2. 브랜드 리스트 조회
3. 브랜드 상품 리스트 조회
4. 브랜드 초성 조회
5. 카테고리별 상품 리스트 조회
6. 할인 품목 조회
7. 검색 품목 조회
8. 품목 상세 정보 조회

### 유틸/dto 테스트
1. DB에서 읽어온 object를 mapping한다.
2. 오늘 할인 품목 object mapper 테스트
3. 역대 최저가 품목 object mapper 테스트

## 캐시

### 캐시 클래스 단위 테스트
1. 로컬캐시가 없다면 글로벌 캐시 사용
2. 로컬캐시, 글로벌 캐시 둘다 없다면 null반환
3. 로컬캐시가 있다면 로컬 캐시를 사용
4. 글로벌 캐시에 오류가 있다면 fallback발동
5. 글로벌 캐시에 값이 있다면 로컬 캐시에 저장
6. 캐시를 초기화하면 로컬, 글로벌 캐시 초기화 
7. 로컬 캐시가 있고 글로벌 캐시가 없다면 동기화
8. 로컬 캐시와 글로벌 캐시의 값이 같다면 동기화x
9. 로컬 캐시와 글로벌 캐시 값이 없다면 동기화 
   
### 서비스로직 단위 테스트
1. 캐시된 데이터가 없으면 업데이트 날짜를 캐시한다.
2. 글로벌 캐시와 로컬 캐시가 다르면 동기화를 진행한다.
3. 글로벌 캐시와 로컬 캐시가 같으면 동기화를 진행하지 않는다.
4. 데이터가 업데이트되지 않으면 cache를 유지한다
5. 캐시된 업데이트 날짜 데이터를 반환한다
6. 데이터가 업데이트되면 cache가 지워진다

### 통합/컨트롤러 테스트
1. 새로 만든 캐시매니저를 사용
2. 캐시를 사용하여 호출한다.
3. 캐시를 초기화 한다.
4. 글로벌 캐시와 로컬 캐시가 같아 동기화 하지 않는다.
5. 글로벌 캐시와 로컬 캐시가 달라 동기화 한다.


### Coverage
#### Total Line Coverage = 81%  
#### Total Branch Coverage = 83%